<Project DefaultTargets="DotNetInterfaceGenerator" Sdk="Microsoft.NET.Sdk">
  <Import Project="$(MSBuildThisFileDirectory)..\..\..\..\xlw.version.props"/>
  <PropertyGroup>
    <!--<TargetFrameworks>net472;net5.0;netcoreapp3.1</TargetFrameworks>-->
    <TargetFrameworks>net472;net5.0;netcoreapp3.1</TargetFrameworks>
    <Platforms>x64;x86</Platforms>
    <XLWDOTNETDIR>$(MSBuildThisFileDirectory)..\..\..</XLWDOTNETDIR>
  </PropertyGroup>


  <PropertyGroup>
    <cplatform>$(Platform)</cplatform>
    <cplatform Condition=" '$(Platform)' == 'x86' ">Win32</cplatform>
    <gd></gd>
    <gd Condition=" '$(Configuration)' == 'Debug' ">-gd</gd>
    <XLW>$(XLWDOTNETDIR)\lib\$(cplatform)\$(Configuration)\$(TargetFramework)</XLW>
    <OutputPath>$(Configuration)\$(cplatform)</OutputPath>
    <AssemblyName>$(MSBuildProjectName).NET</AssemblyName>
  </PropertyGroup>

  <ItemGroup>
    <Reference Include="xlwDotNet">
      <HintPath>$(XLW)\xlwDotNet-vc142-mt$(gd)-$(XLWVersion).dll</HintPath>
    </Reference>
  </ItemGroup>

  <Target Name="DotNetInterfaceGenerator" AfterTargets="Build" Condition=" '$(TargetFramework)' != '' ">
    <Message Importance="high" Text="AFTERBUILD" />
    <Message Importance="high" Text="$(XLW)\DotNetInterfaceGenerator.exe $(OutputPath)$(AssemblyName).dll $(MSBuildProjectName) AutoGeneratedSource DLL" />
    <Exec ConsoleToMsBuild="true" Command="$(XLW)\DotNetInterfaceGenerator.exe $(OutputPath)$(AssemblyName).dll $(MSBuildProjectName) AutoGeneratedSource DLL"></Exec>
  </Target>

 
</Project>